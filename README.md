# TrialsOfOsirisBot
The original bot I wrote in 2015, meant to track and display information about Destiny 1's Trials of Osiris mode for Twitch streamers. I used Node.js to power the bot because  I needed a way to have an ongoing-process to poll an API and display results in a Twitch chat. 

## History
In May of 2015, game developer Bungie released an expansion DLC for their first-person-looter-shooter, Destiny, called House of Wolves. Part of this DLC expansion included a brand-new, end-game PVP competitive mode, called _Trials of Osiris_. This mode was only available from Fridays at 10am Pacific time until the game's next weekly reset, the following Tuesday, usually around 2am Pacific. The goal of _Trials of Osiris_ was for your team to go "flawless", and get awarded access to an exclusive area called, "The Lighthouse", where players could receive exclusive guns and armor. In order to participate in _Trials of Osiris_, players needed to obtain a Trials Passage from an NPC vendor in one of the game's social spaces. The Trials Passage recorded the number of wins and losses for the player. 9 total wins on the Passage itself, without any losses, granted access to The Lighthouse. Along with the Passage, players could also buy "boons" which modified their Trials Passage.

If a player activated all three boons on their Trials Passage, they technically only needed to win 7 total games in order to reach The Lighthouse. If a player's Trials Passage maxed out at 3 total losses, the player would be forced to reacquire a new Trials Passage, with new boons, which were sorta-kinda gate-kept behind rare, in-game currency. 

When Trials of Osiris came out, a lot of players realized that the skill ceiling required to go flawless and reach The Lighthouse was much higher than they expected. This lead to a wave of gamers seeking out help in order to be able to obtain some of the highest-end gear Destiny had to offer. Some Destiny Twitch streamers, offered raffle services to less-experienced and lesser-skilled players the chance to get to The Lighthouse and get some sweet loot (these players were commonly referred to in the community as "sherpees", where streamers who were good enough to compensate for their guest were called "sherpas"). I was moderating for a Destiny-streamer at the time, and had the thought to setup a bot for their Twitch chat that would be able to record wins and losses, because often, viewers interested in watching Trials of Osiris would tune in mid-Passage and seeing how many wins the current Passage had wasn't easy to show over Twitch. 

At first, TrialsTrainBot was rudimentary. It wasn't dynamic, it didn't look up any information on its own, it was merely setup to handle manual commands by the streamer's chat moderators to be able to record the status of the current Trials Passage, using commands like `!win`, `!loss`, `!mercy`, etc. 

I then decided to take TrialsTrainBot to the next level. Bungie had already opened some of its API to third-party developers, and these developers were building amazing stat-tracking and analytics sites based around Destiny and the Trials of Osiris game mode. Tools like DestinyItemManager (which allowed players to manage inventory via a mobile app or website). After signing up for a Bungie.net API key, I then setup Node.js on my personal VPS, and researched how I might get a bot working on Twitch. 

The first iteration of the bot that was powered by Bungie's API actually had to manage its own Trials Passage data, as Bungie hadn't yet built out their API to provide Trials-specific data. So instead, I wrote the bot to record the Sherpee's progress simply based on the latest games they played from their Crucible (PVP) data for that active character. _Trials of Osiris_ games were at least still provided via the API, however, I quickly became aware that this data wasn't real time. Through some research on Bungie's API forum, I found out that the API is updated after-the-fact with data from a separate server that actually handled recording the match data. This meant that some times, the bot's reporting of the Trials Passage status could and would be delayed. 

Over time, I added other useful commands for the streamer to use the bot with, such as being able to "scout" other players by providing their gamertags as input, and TrialsTrainBot would go through that player's 25 last games and provide total wins, possible win streaks, win-loss ratio, and kill-death ratios. This allowed the streamer to see at a glance what kind of team he and his partner would be up against. Also, added the ability for the streamer to post tweets to their Twitter profile via the bot, through Twitch chat. 

## Current Version

The current version presented here is as it was when I last worked on it. This version is an upgrade from the one discussed above, after Bungie had added proper _Trials of Osiris_ game data to their API. Since _Trials of Osiris_ was also only played (at least at first) on one map each weekend, the data sent back by Bungie's API also reported what map would be played that weekend. Bungie wouldn't announce which map _Trials of Osiris_ was taking place on before the game mode went live on Friday mornings at 10am Pacific, so players would often announce their predictions of what map it would be for that weekend. For this reason, I added a way to allow viewers to cast their map predictions with the bot, and when the game mode went live at 10am Friday, the data set from the API changed and the bot would announce not only the map being played for that weekend, but also which viewers had correctly predicted the map. 

I also added a way for viewers to interface with a stat-tracking website via TrialsTrainBot, wherein players could get stats and facts on their characters, and TrialsTrainBot would send them a "whisper" (eg, a private message) via Twitch with the data they asked for. I decided to implement this because Bungie's API was rate-limited back then, and because the bot had to poll Bungie's API on interval to get updates on the last match played, we reduced viewer stat requests to once every ten minutes to help alleviate maxing out the rate-liming in the Bungie API. Then, because sometimes the streamer wanted to take those viewers of his channel to The Lighthouse if they had never been before, I added a way to check for a gamertag's status on having a special item unlocked, which only happens on their very first visit to The Lighthouse. This allowed the Sherpa to check whether a gamertag was trying to lie their way into a raffle they weren't eligible for. 

The last, major feature I added to the bot, was actually to integrate authentication from Xbox Live and PlayStation Network for the Sherpa. This meant a fundamental change to the way TrialsTrainBot dealt with _Trials of Osiris_ Passages, where sherpees had to buy all three Boons for their Trials Passage, and the Sherpa would do the same, and the bot would then just track the progress of the Sherpa's Trials Passage, effectively mirroring the sherpee's Trials Passage as well. This helped to eliminate errors in cases of gamertags using lowercase L's as uppercase i's, and the like. 

## Related to Trials Train Bot

* __Cambot.js__, a bot meant for interfacing with AutoHotKey on a streamer's machine to be able to change scenes in OBS 


# Cambot.js

Cambot.js was also developed for the above-mentioned Twitch streamer, when he planned to have two of his other streamer friends over for a gaming weekend of _Trials of Osiris_ in Destiny, all in the same room. Because we had different POVs available to combine into one stream, we developed a method, using this bot installed locally on the streamer's machine and run with Node.js, along with the Windows program _AutoHotKey_ in order to trigger hot key commands that Open Broadcasting Software (OBS) would detect, and thus use to change scenes. 

The idea was that we wanted viewers to be able to vote on certain POVs. They could choose any of the three streamers to focus on, vote for what they wanted, and when the voting was over, the bot would run the _AutoHotKey_ function to trigger the appropriate scene. This bot could also trigger any scene change with a direct command.
